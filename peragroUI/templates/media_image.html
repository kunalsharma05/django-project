{% load staticfiles %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title></title>

    <!-- Bootstrap -->
     <link href="{% static 'peragroUI/css/vendors/bootstrap/dist/css/bootstrap.min.css' %}" type="text/css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link href="{% static 'peragroUI/css/vendors/font-awesome/css/font-awesome.min.css' %}" type="text/css" rel="stylesheet" />

    <!-- <link href="../vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet"> -->
    <!-- Animate.css -->
    
    <link href="https://colorlib.com/polygon/gentelella/css/animate.min.css" rel="stylesheet">

    <link href="{% static 'peragroUI/css/custom.min.css' %}" rel="stylesheet" type="text/css" />
  </head>
<!--  -->
 <body class="nav-md">
    <div class="container body">
      <div class="main_container">
        <div class="row" stlye="background:738B8C">
        <div class="col-md-9">
         <div class="clearfix"></div>
         <div class="x_panel">         
                  <div class="x_content" style="text-align: center;">
                      
                      <button id="clear-canvas" class="btn btn-info">Clear Canvas</button><br>
				<button id="get-json" class="btn btn-info">Get JSON</button><br>
				 <label for="drawing-color">Line color:</label>
				    <input type="color" value="#f55f55" id="color-select">
				  <label for="drawing-line-width">Line width:</label>
				   <p id="width">5</p> <input type="range" value="5" min="0" max="150" id="width-select"><br>

				<h2>Canvas for drawing</h2>

				    
				<div class="jumbotron" style="width: 100%; height: 100%; position: relative; -moz-user-select: none; background: none; text-align: center; align-self: center; margin:0px auto;" class="canvas-container"><canvas class="lower-canvas" id="c"  style="border: 1px solid rgb(170, 170, 170); position: relative; left: 0px; top: 0px; -moz-user-select: none;"></canvas></div>

				<h3>This element shows the JSON output, to see deserialization, clear the canvas and press deserialize</h3>
				<div>
				<p id = "set-json"></p>
				</div>
				<button id="clear-json" class="btn btn-info">Clear JSON output</button><br>
				<button id="deserialize-json" class="btn btn-info">Deserialize JSON output</button><br>
				<button id="insert-text" class="btn btn-info">Insert Text: OFF</button><br>

                  </div>
                </div>
              </div>
            

	        <div class="col-md-3">
	          <div class="x_panel">
	            <!-- /menu profile quick info -->
	            <div class="tab-pane fade active in" id="tab_content1" aria-labelledby="home-tab">

                            <!-- start recent activity -->
                            <ul class="messages">
                              <li>
                                <img src="" class="avatar" alt="Avatar">
                                <div class="message_date">
                                  <h4 class="date text-info">24</h4>
                                  <p class="month">May</p>
                                </div>
                                <div class="message_wrapper">
                                  <h4 class="heading">Desmond Davison</h4>
                                  <blockquote class="message" style="font-size: 12px;"><p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown aliqua butcher retro keffiyeh dreamcatcher synth.</p></blockquote>
                                  <br />
                                  <p class="url">
                                    <span class="fs1 text-info" aria-hidden="true" data-icon="îƒ…"></span>
                                    <a href="#"><i class="fa fa-paperclip"></i> User Acceptance Test.doc </a>
                                  </p>
                                </div>
                              </li>

                                                              
                              <li>
                              	<img src="" class="avatar" alt="Avatar">
                              <div class="message_date">
                                  <h4 class="date text-info"></h4>
                                  <p id="com_date" class="month"></p>
                                </div>
                              <div class="message_wrapper">
                                  <h4 class="heading"></h4>
                                  <blockquote class="message" style="font-size: 12px;"><textarea></textarea></blockquote>

                              </li>
                            </ul>
                            <!-- end recent activity -->

                          </div>
	            </div>

	            <!-- sidebar menu -->
	           	          </div>
	        </div>
		</div>
		</div>
        <!-- top navigation -->
        <!-- <div class="top_nav">
          <div class="nav_menu">
            <nav class="" role="navigation">
              <div class="nav toggle">
                <a id="menu_toggle"><i class="fa fa-bars"></i></a>
              </div>

              <ul class="nav navbar-nav navbar-right">
                <li class="">
                  <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <img src="images/img.jpg" alt="">{{user.first_name}} {{user.last_name}}
                    <span class=" fa fa-angle-down"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-usermenu pull-right">
                    <li><a href="javascript:;"> Profile</a></li>
                    <li>
                      <a href="javascript:;">
                        <span class="badge bg-red pull-right">50%</span>
                        <span>Settings</span>
                      </a>
                    </li>
                    <li><a href="javascript:;">Help</a></li>
                    <li><a href="login.html"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                  </ul>
                </li>
 -->
                <!--  FOR THE NOTIFICATIONS MODULE
                <li role="presentation" class="dropdown">
                  <a href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                    <i class="fa fa-envelope-o"></i>
                    <span class="badge bg-green">6</span>
                  </a>
                  <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                    <li>
                      <a>
                        <span class="image"><img src="images/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time"></span>
                        </span>
                        <span class="message">
                          
                        </span>
                      </a>
                    </li> -->
                    <!-- <li>
                      <div class="text-center">
                        <a>
                          <strong>See All Alerts</strong>
                          <i class="fa fa-angle-right"></i>
                        </a>
                      </div>
                    </li> -->
                  <!-- </ul> -->
                <!-- </li> -->
<!--               </ul>
            </nav>
          </div>
        </div>
 -->        <!-- /top navigation -->

        <!-- page content -->
        
        <!-- /page content -->

        <!-- footer content -->
        <footer style="margin-left:0px">
          <div class="pull-right pull-bottom">
            Digital Assets Managed Neatly
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>

    <!-- jQuery -->
   <script src="{% static 'peragroUI/css/vendors/jquery/dist/jquery.min.js' %}"></script>
    <!-- Bootstrap -->
    <script src="{% static 'peragroUI/css/vendors/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <!-- FastClick -->
    <script src="{% static 'peragroUI/css/vendors/fastclick/lib/fastclick.js' %}"></script>
    <!-- NProgress -->
    <script src="{% static 'peragroUI/css/vendors/nprogress/nprogress.js' %}"></script>
    <!-- morris.js -->
    <script src="{% static 'peragroUI/css/vendors/raphael/raphael.min.js' %}"></script>
    <script src="{% static 'peragroUI/css/vendors/morris.js/morris.min.js' %}"></script>
    <!-- bootstrap-progressbar -->
    <script src="{% static 'peragroUI/css/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js' %}"></script>
    <!-- bootstrap-daterangepicker -->
    <script src="{% static 'peragroUI/js/moment/moment.min.js' %}"></script>
    <script src="{% static 'peragroUI/js/datepicker/daterangepicker.js' %}"></script>

<!--     FabricJS
 -->    <script src="{% static 'peragroUI/build/js/fabric.min.js' %}"></script>
    
    <!-- Custom Theme Scripts -->
    <script src="{% static 'peragroUI/build/js/custom.min.js' %}"></script>
<script id="main">(function() {
  var $ = function(id){return document.getElementById(id)};

  
  var canvas = this.__canvas = new fabric.Canvas('c', {
    isDrawingMode: true
  });
fabric.Image.fromURL('/media/{{media_ob.media.name}}/', function(oImg) {
  canvas.add(oImg);
  canvas.setWidth(oImg.width);
  canvas.setHeight(oImg.height);
	});
 
   months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']
   d = new Date();
   $('com_date').innerHTML = months[d.getMonth()];

  canvas.freeDrawingBrush.color = "#f55";
  canvas.freeDrawingBrush.width = 5;


  var clearCanvas = $('clear-canvas');
  var clearSerialOutput = $('clear-json');
  var getJson = $('get-json');
  var setJson = $('set-json');
  var deserialize = $('deserialize-json');
  var colorselector = $('color-select');
  var widthselector = $('width-select');
  var widthdisplay = $('width');
  var inserttext = $('insert-text');
  var flag = 0;
  colorselector.onchange = function() {
      canvas.freeDrawingBrush.color = this.value;
    };

  widthselector.onchange = function() {
      canvas.freeDrawingBrush.width = parseInt(widthselector.value, 10) || 1;
      widthdisplay.innerHTML = widthselector.value;
  };


  getJson.onclick = function() { 
    console.log(JSON.stringify(canvas));
    setJson.innerHTML = JSON.stringify(canvas);
    console.log("----------------------------------");
    };    
  
  clearCanvas.onclick = function() { 
    canvas.clear();
    };
  
  clearSerialOutput.onclick = function() { 
    setJson.innerHTML = "";
    };

  deserialize.onclick = function() {
    canvas.loadFromJSON(setJson.innerHTML,canvas.renderAll.bind(canvas));
  };
  
  inserttext.onclick = function() {
    if (flag == 0){
      flag = 1;
      inserttext.innerHTML = "Insert Text ON";
        console.log(flag);
        canvas.isDrawingMode = !canvas.isDrawingMode;

    }
    else if (flag == 1){
      flag = 0;
      inserttext.innerHTML = "Insert Text OFF";
        console.log(flag);
        canvas.isDrawingMode = !canvas.isDrawingMode;
    }
  };

  
  canvas.on('mouse:down', function(options) {
  if(flag == 1) {
    if (options.target == null){ 
        addText(options.e);
        console.log(flag);
      }
  }
  });


  function addText(e) {

  var custontxt=new fabric.IText('Start Typing', { 
  fontFamily: 'helvetica',
  fontSize:30,
  fontWeight:400,
  fill:'red', 
  fontStyle: 'normal', 
  top:e.offsetY,
  cursorDuration:500,    
  left:e.offsetX,   
  });  
  canvas.add(custontxt);
  custontxt.enterEditing();
  }

})();
</script>
  </body>
</html>
